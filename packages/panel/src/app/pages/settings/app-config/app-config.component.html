<form [formGroup]="form">
  <mat-toolbar class="page-toolbar">
    <button mat-icon-button goBack>
      <i class="fa-regular fa-arrow-right fa-large"></i>
    </button>
    <h1 flex>{{ 'settings.appConfig' | translate }}</h1>
    <button mat-flat-button color="primary" (click)="save()" [disabled]="saving || !form.dirty">
      {{ 'app.save' | translate }}
    </button>
  </mat-toolbar>
  <main class="form-page-layout content-wrapper">
    <div class="flex-col">
      <mat-card>
        <mat-card-header>
          <mat-card-title>{{ 'appConfig.themeSection' | translate }}</mat-card-title>
        </mat-card-header>
        <span spacer-2x></span>
        <mat-card-content>
          <mat-form-field>
            <mat-label>{{ 'appConfig.theme' | translate }}</mat-label>
            <mat-select formControlName="theme">
              <mat-option *ngFor="let t of themes" [value]="t">
                <i class="fa-solid fa-circle" [style.color]="t.primaryColor"></i>
                {{ t.title }}
              </mat-option>
            </mat-select>
            <i
              matSuffix
              [style.color]="form.controls['theme'].value?.primaryColor"
              class="fa-solid fa-circle"
              style="width: 48px; text-align: center"
            ></i>
          </mat-form-field>
          <span spacer-2x></span>
          <mat-form-field>
            <mat-label>{{ 'appConfig.themeMode' | translate }}</mat-label>
            <mat-select formControlName="themeMode">
              <mat-option [value]="ThemeMode.Auto">
                {{ 'appConfig.themeModeAuto' | translate }}
              </mat-option>
              <mat-option [value]="ThemeMode.Dark">
                {{ 'appConfig.themeModeDark' | translate }}
              </mat-option>
              <mat-option [value]="ThemeMode.Light">
                {{ 'appConfig.themeModeLight' | translate }}
              </mat-option>
              <!-- <mat-option [value]="ThemeMode.Manual">
                {{ 'appConfig.themeModeManual' | translate }}
              </mat-option> -->
            </mat-select>
            <mat-hint *ngIf="form.controls['themeMode'].value === ThemeMode.Auto">{{
              'appConfig.themeModeAutoHint' | translate
            }}</mat-hint>
          </mat-form-field>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-card-header>
          <mat-card-title>{{ 'appConfig.menuSection' | translate }}</mat-card-title>
        </mat-card-header>
        <span spacer-2x></span>
        <mat-card-content>
          <mat-form-field>
            <mat-label>{{ 'appConfig.menuViewType' | translate }}</mat-label>
            <mat-select formControlName="menuViewType">
              <mat-option [value]="MenuViewType.Manual">
                {{ 'appConfig.menuViewTypeManual' | translate }}
              </mat-option>
              <mat-option [value]="MenuViewType.Grid">
                {{ 'appConfig.menuViewTypeGrid' | translate }}
              </mat-option>
              <mat-option [value]="MenuViewType.Card">
                {{ 'appConfig.menuViewTypeCard' | translate }}
              </mat-option>
              <mat-option [value]="MenuViewType.Compact">
                {{ 'appConfig.menuViewTypeCompact' | translate }}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <ng-container>
            <mat-form-field>
              <mat-label>{{ 'appConfig.menuCols' | translate }}</mat-label>
              <mat-select formControlName="menuCols">
                <mat-option [value]="2">
                  {{ 'appConfig.menuColsText' | translate: { value: 2 } }}
                </mat-option>
                <mat-option [value]="3">
                  {{ 'appConfig.menuColsText' | translate: { value: 3 } }}
                </mat-option>
                <mat-option [value]="4">
                  {{ 'appConfig.menuColsText' | translate: { value: 4 } }}
                </mat-option>
              </mat-select>
              <mat-hint>{{ 'appConfig.menuColsHint' | translate }}</mat-hint>
            </mat-form-field>
          </ng-container>
        </mat-card-content>
      </mat-card>
    </div>

    <div class="flex-col">
      <mat-card>
        <mat-toolbar>
          <b flex>
            {{ 'appConfig.disableOrdering' | translate }}
          </b>
          <mat-button-toggle-group formControlName="disableOrdering">
            <mat-button-toggle [value]="false">{{ 'app.active' | translate }}</mat-button-toggle>
            <mat-button-toggle [value]="true" color="warn">{{
              'app.inactive' | translate
            }}</mat-button-toggle>
          </mat-button-toggle-group>
        </mat-toolbar>
        <mat-card-content>
          <mat-form-field *ngIf="form.controls['disableOrdering']?.value">
            <mat-label>{{ 'appConfig.disableOrderingText' | translate }}</mat-label>
            <textarea matInput formControlName="disableOrderingText" rows="2"></textarea>
            <mat-hint>{{ 'app.optional' | translate }}</mat-hint>
          </mat-form-field>

          <span spacer-2x></span>

          <mat-form-field *ngIf="!form.controls['disableOrdering']?.value">
            <mat-label>{{ 'appConfig.orderingTypes' | translate }}</mat-label>
            <mat-select formControlName="orderingTypes" multiple>
              <mat-option [value]="OrderType.DineIn">
                {{ 'orderType.dineIn' | translate }}
              </mat-option>
              <mat-option [value]="OrderType.Takeaway">
                {{ 'orderType.takeaway' | translate }}
              </mat-option>
              <mat-option [value]="OrderType.Delivery">
                {{ 'orderType.delivery' | translate }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <span spacer></span>

          <mat-form-field>
            <mat-label>{{ 'appConfig.selectableOrderTypes' | translate }}</mat-label>
            <mat-select formControlName="selectableOrderTypes" multiple>
              <mat-option [value]="OrderType.DineIn">
                {{ 'orderType.dineIn' | translate }}
              </mat-option>
              <mat-option [value]="OrderType.Takeaway">
                {{ 'orderType.takeaway' | translate }}
              </mat-option>
              <mat-option [value]="OrderType.Delivery">
                {{ 'orderType.delivery' | translate }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <span spacer></span>

          <mat-form-field>
            <mat-label>{{ 'appConfig.requiredRegister' | translate }}</mat-label>
            <mat-select formControlName="requiredRegister" multiple>
              <mat-option [value]="OrderType.DineIn">
                {{ 'orderType.dineIn' | translate }}
              </mat-option>
              <mat-option [value]="OrderType.Takeaway">
                {{ 'orderType.takeaway' | translate }}
              </mat-option>
              <mat-option [value]="OrderType.Delivery">
                {{ 'orderType.delivery' | translate }}
              </mat-option>
            </mat-select>
          </mat-form-field>

          <span spacer></span>

          <mat-checkbox formControlName="disableOrderingOnClose" color="warn">
            {{ 'appConfig.disableOrderingOnClose' | translate }}
          </mat-checkbox>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-toolbar>
          <b class="flex">
            {{ 'appConfig.disablePayment' | translate }}
          </b>
          <mat-button-toggle-group formControlName="disablePayment">
            <mat-button-toggle [value]="false">{{ 'app.active' | translate }}</mat-button-toggle>
            <mat-button-toggle [value]="true" color="warn">{{
              'app.inactive' | translate
            }}</mat-button-toggle>
          </mat-button-toggle-group>
        </mat-toolbar>
        <mat-card-content *ngIf="!form.controls['disablePayment']?.value">
          <mat-form-field>
            <mat-label>{{ 'appConfig.requiredPayment' | translate }}</mat-label>
            <mat-select formControlName="requiredPayment" multiple>
              <mat-option [value]="OrderType.DineIn">
                {{ 'orderType.dineIn' | translate }}
              </mat-option>
              <mat-option [value]="OrderType.Takeaway">
                {{ 'orderType.takeaway' | translate }}
              </mat-option>
              <mat-option [value]="OrderType.Delivery">
                {{ 'orderType.delivery' | translate }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </mat-card-content>
      </mat-card>

      <mat-card>
        <mat-toolbar>
          <b class="flex">
            {{ 'appConfig.ding' | translate }}
          </b>
          <mat-button-toggle-group formControlName="ding">
            <mat-button-toggle [value]="true">{{ 'app.active' | translate }}</mat-button-toggle>
            <mat-button-toggle [value]="false" color="warn">{{
              'app.inactive' | translate
            }}</mat-button-toggle>
          </mat-button-toggle-group>
        </mat-toolbar>
        <mat-card-content *ngIf="form.controls['ding']?.value">
          <mat-form-field>
            <mat-label>{{ 'appConfig.dingsLabel' | translate }}</mat-label>
            <mat-chip-grid #chipGrid>
              <mat-chip-row *ngFor="let phone of form.controls['dings'].value" (removed)="removeDing(phone)">
                {{ phone }}
                <button matChipRemove>
                  <i class="fa-regular fa-close"></i>
                </button>
              </mat-chip-row>
              <input
                placeholder="{{ 'appConfig.dingsPlaceholder' | translate }}"
                [matChipInputFor]="chipGrid"
                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                [matChipInputAddOnBlur]="true"
                (matChipInputTokenEnd)="addDing($event)"
              />
            </mat-chip-grid>
            <mat-hint>{{ 'appConfig.dingsHint' | translate }}</mat-hint>
          </mat-form-field>
        </mat-card-content>
      </mat-card>
    </div>
  </main>
</form>

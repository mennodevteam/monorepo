<table mat-table [dataSource]="orders() || []">
  <ng-container matColumnDef="customer">
    <th mat-header-cell *matHeaderCellDef>{{ 'order.customer' | translate }}</th>
    <td mat-cell *matCellDef="let order">
      @if (order.customer?.mobilePhone) {
        <button mat-button>
          {{ User.fullName(order.customer) }}
        </button>
        <a mat-button href="tel://{{ order.customer.mobilePhone }}" eng>
          {{ order.customer.mobilePhone }}
        </a>
      }
    </td>
  </ng-container>

  <ng-container matColumnDef="createdAt">
    <th mat-header-cell *matHeaderCellDef>{{ 'app.date' | translate }}</th>
    <td mat-cell *matCellDef="let order" style="width: 210px">
      {{ order.createdAt | pdate: true }}
    </td>
  </ng-container>

  <ng-container matColumnDef="type">
    <th mat-header-cell *matHeaderCellDef>{{ 'app.type' | translate }}</th>
    <td mat-cell *matCellDef="let order" style="width: 48px">
      @switch (order.type) {
        @case (OrderType.DineIn) {
          <i class="fa-solid fa-mug-hot"></i>
        }
        @case (OrderType.Delivery) {
          @if (order.address?.deliveryArea?.isPost) {
            <i class="fa-solid fa-truck-fast"></i>
          } @else {
            <i class="fa-solid fa-moped"></i>
          }
        }
        @case (OrderType.Takeaway) {
          <i class="fa-solid fa-cart-shopping"></i>
        }
      }
    </td>
  </ng-container>

  <ng-container matColumnDef="price">
    <th mat-header-cell *matHeaderCellDef>{{ 'app.price' | translate }}</th>
    <td mat-cell *matCellDef="let order" style="width: 180px">
      <b [class.success-text]="order.paymentType">
        {{ order.totalPrice | number | menuCurrency }}
        @if (order.paymentType) {
          <i class="fa-solid fa-check"></i>
        }
      </b>
    </td>
  </ng-container>

  <ng-container matColumnDef="state">
    <th mat-header-cell *matHeaderCellDef>{{ 'app.status' | translate }}</th>
    <td mat-cell *matCellDef="let order" style="width: 160px">
      <app-order-state-chip
        stopPropagation
        [state]="order.state"
        (stateChange)="stateChange.emit({ order, state: $event })"
      />
    </td>
  </ng-container>

  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef></th>
    <td mat-cell *matCellDef="let order" style="width: 128px">
      <button mat-icon-button routerLink="/orders/edit/{{ order.id }}" stopPropagation>
        <i class="fa-regular fa-edit"></i>
      </button>
      <button mat-icon-button>
        <i class="fa-regular fa-trash-alt"></i>
      </button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr
    mat-row
    *matRowDef="let row; columns: displayedColumns"
    class="selectable-row"
    (click)="navigateToOrder(row)"
  ></tr>
</table>

<mat-toolbar>
  <mat-toolbar-row>
    <button mat-icon-button goBack>
      <i class="fa-regular fa-arrow-right"></i>
    </button>
    <h1 flex>{{ product?.title }}</h1>
  </mat-toolbar-row>
</mat-toolbar>

<main *ngIf="product">
  <img id="product-image" [imageLoader]="product.images ? product.images[0] : undefined" />

  <p class="outline-text">{{ product.description }}</p>

  <mat-toolbar>
    <mat-toolbar-row class="price-section">
      <p *ngIf="!Product.hasDiscount(product)" flex>{{ 'app.price' | translate }}</p>
      <span class="price-section__text">
        <span class="price-section__text__old error-text" *ngIf="Product.hasDiscount(product)">
          {{ Product.realPrice(product) | menuCurrency }}
        </span>
        <b class="secondary-text">{{ Product.totalPrice(product) | menuCurrency }}</b>
      </span>
      <ng-container *ngIf="Product.hasDiscount(product)">
        <span flex></span>
        <discount-badge>
          {{ 'discount.percentage' | translate: { value: Product.percentageDiscount(product) } }}
        </discount-badge>
      </ng-container>
    </mat-toolbar-row>
    <mat-toolbar-row style="height: 72px" *ngIf="product?._orderItem?.quantity">
      {{ 'app.count' | translate }}
      <span style="flex: 1"></span>
      <count-selector [count]="1" (plusClick)="plus()" (minusClick)="minus()"></count-selector>
    </mat-toolbar-row>
    <span #selectButtonRow></span>
  </mat-toolbar>

  <ng-container *ngIf="shopService.hasOrderingPlugin()">
    <button
      mat-stroked-button
      [disabled]="product.status === Status.Blocked"
      *ngIf="!product?._orderItem?.quantity"
      (click)="plus()"
      class="add-button"
    >
      <span *ngIf="product.status === Status.Active">{{ 'app.select' | translate }}</span>
      <span *ngIf="product.status === Status.Blocked">{{ 'app.finished' | translate }}</span>
    </button>

    <div style="height: 72px"></div>

    <mat-toolbar class="actions background mat-elevation-z5">
      <button mat-stroked-button color="primary" goBack>
        {{ 'productPage.backMenu' | translate }}
      </button>
      <span spacer></span>
      <button
        flex
        mat-raised-button
        *ngIf="product?._orderItem?.quantity"
        color="primary"
        routerLink="/basket"
        [disabled]="!basket.items.length"
      >
        {{ 'productPage.complete' | translate }}
      </button>
      <button
        flex
        mat-raised-button
        [disabled]="product.status === Status.Blocked"
        *ngIf="!product?._orderItem?.quantity"
        color="primary"
        (click)="plus(true)"
      >
        <span *ngIf="product.status === Status.Active">{{ 'app.select' | translate }}</span>
        <span *ngIf="product.status === Status.Blocked">{{ 'app.finished' | translate }}</span>
      </button>
    </mat-toolbar>
  </ng-container>
</main>
